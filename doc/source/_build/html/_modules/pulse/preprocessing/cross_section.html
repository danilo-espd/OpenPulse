
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pulse.preprocessing.cross_section &#8212; OpenPulse  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/pulse.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../index.html">
  <img src="../../../_static/pulse.PNG" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../installing/installing.html">
  Installing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../guides/index.html">
  How-to Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../code_reference/index.html">
  Code reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../theory_reference/index.html">
  Theory reference
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-pulse/OpenPulse" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pulse.preprocessing.cross_section</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">atan</span><span class="p">,</span> <span class="n">isnan</span><span class="p">,</span> <span class="n">isinf</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span><span class="p">,</span> <span class="n">pinv</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csc_matrix</span><span class="p">,</span> <span class="n">coo_matrix</span>
<span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">spilu</span><span class="p">,</span> <span class="n">svds</span><span class="p">,</span> <span class="n">splu</span><span class="p">,</span> <span class="n">spsolve</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">svd</span>

<span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">N_int_points</span> <span class="o">=</span> <span class="mi">4</span>

<div class="viewcode-block" id="_gauss_quadrature2D"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section._gauss_quadrature2D">[docs]</a><span class="k">def</span> <span class="nf">_gauss_quadrature2D</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns the Gauss quadrature points and wights for a 2D integration over a square with two integration points. The nodes coordinates are :math:`n_i=\\frac{1}{\\sqrt{3}}(\\pm 1, \\pm 1)` as illustrated: ::</span>

<span class="sd">            </span>
<span class="sd">              y</span>
<span class="sd">              ^</span>
<span class="sd">              |</span>
<span class="sd">        +-----------+       </span>
<span class="sd">        |  *  |  *  |       </span>
<span class="sd">        |     |     |       </span>
<span class="sd">        |     +---- | --&gt; x </span>
<span class="sd">        |           |       </span>
<span class="sd">        |  *     *  |       </span>
<span class="sd">        +-----------+       </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    points : (4,2) array</span>
<span class="sd">        Each line corresponds to an integration points :math: `(x,y)` in the normalized domain :math:`[-1,1]\\times[-1,1]`.</span>

<span class="sd">    weights : float</span>
<span class="sd">        Weights of the respective integration points in the sum approximation. In this case, the weights are all equal to 1.</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    _get_all_shape_functions : Shape function and its derivative for all the integration points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span>

    <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">c</span>
    <span class="n">points</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">c</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">weight</span></div>

<div class="viewcode-block" id="_shape_function"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section._shape_function">[docs]</a><span class="k">def</span> <span class="nf">_shape_function</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function returns the Q9 (9-node quadrilateral element) two dimensional quadratic shape function and its derivative for a given point in the normalized coordinate system :math:`(s,t) \\in [-1,1]\\times[-1,1]`. The shape functions are:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\varphi_i (s, t) &amp;= \\frac{1}{4}(s^2 + s_i s)(t^2 + t_i t),\\; \\text{nodes } (s_i,t_i),\\; i=1,\\dots,4. \\\\</span>
<span class="sd">        \\varphi_i (s, t) &amp;= \\frac{1}{2}(1 - s^2)(t^2 + t_i t),\\; \\text{nodes } (s_i,t_i),\\; i=5,7. \\\\</span>
<span class="sd">        \\varphi_i (s, t) &amp;= \\frac{1}{2}(s^2 + s_i s)(1 - t^2),\\; \\text{nodes } (s_i,t_i),\\; i=6,8. \\\\</span>
<span class="sd">        \\varphi_9 (s, t) &amp;= (1 - s^2)(1 - t^2).</span>

<span class="sd">    The nodes coordinates are:</span>

<span class="sd">    ====  ===========  ===========</span>
<span class="sd">    Node  :math:`s_i`  :math:`t_i`</span>
<span class="sd">    ====  ===========  ===========</span>
<span class="sd">    1     -1           -1</span>
<span class="sd">    2     1            -1</span>
<span class="sd">    3     1             1</span>
<span class="sd">    4     -1            1</span>
<span class="sd">    5     0            -1</span>
<span class="sd">    6     1             0</span>
<span class="sd">    7     0             1</span>
<span class="sd">    8     -1            0</span>
<span class="sd">    9     0             0</span>
<span class="sd">    ====  ===========  ===========</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xi : float in :math:`[-1,1]`.</span>
<span class="sd">        Dimensionless :math:`x` coordinate.</span>

<span class="sd">    eta : float in :math:`[-1,1]`.</span>
<span class="sd">        Dimensionless :math:`y` coordinate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    phi : (9,) array</span>
<span class="sd">        Quadratic shape functions :math:`\\varphi_i (s,t), \\; i=1,\\dots,9`.</span>
<span class="sd">        </span>
<span class="sd">    dphi : (9,2) array</span>
<span class="sd">        Derivatives of the shape functions:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\begin{bmatrix}</span>
<span class="sd">        \\frac{\\partial \\varphi_1}{\\partial s} (s,t), &amp;\\frac{\\partial \\varphi_1}{\\partial t} (s,t) \\\\</span>
<span class="sd">        \\vdots &amp; \\vdots \\\\</span>
<span class="sd">        \\frac{\\partial \\varphi_9}{\\partial s} (s,t), &amp;\\frac{\\partial \\varphi_9}{\\partial t} (s,t)</span>
<span class="sd">        \\end{bmatrix}</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    _get_all_shape_functions : Shape function and its derivative for all the integration points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Shape functions</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> 
    <span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">phi</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Derivatives</span>
    <span class="n">dphi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="c1"># ksi Derivative</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> 
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># eta Derivative</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dphi</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dphi</span></div>

<div class="viewcode-block" id="_get_all_shape_functions"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section._get_all_shape_functions">[docs]</a><span class="k">def</span> <span class="nf">_get_all_shape_functions</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; This function returns the Q9 (9-node quadrilateral element) two dimensional quadratic shape functions and its derivatives for all 2D Gauss quadrature integration points in the normalized coordinate system :math:`(s,t) \\in [-1,1]\\times[-1,1]`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    phi : (4,9) array</span>
<span class="sd">        Quadratic shape function. The row ``phi[i,:]`` corresponds to the ``i``-th integration point and the column ``phi[:,j]`` corresponds to the ``j``-th shape function.</span>

<span class="sd">    dphi : (4,9,2) array</span>
<span class="sd">        Derivatives of the shape functions. The layer ``dphi[i,:,:]`` corresponds to the ``i``-th integration point, the row ``dphi[:,j,:]`` corresponds to the ``j``-th shape function and the column ``dphi[:,:,k]`` corresponds to the derivatives:</span>
<span class="sd">        </span>
<span class="sd">        .. math::        </span>
<span class="sd">            \\left[\\frac{\\partial \\varphi}{\\partial s} (s,t), \\frac{\\partial \\varphi}{\\partial t} (s,t)\\right].</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    _shape_function : Shape function and its derivative for one point.</span>

<span class="sd">    _gauss_quadrature2D : Gauss quadrature data for 2D integration and two integration points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">points</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_gauss_quadrature2D</span><span class="p">()</span>
    <span class="n">mat_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="n">mat_dphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ksi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span> 
        <span class="n">mat_phi</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">mat_dphi</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">_shape_function</span><span class="p">(</span><span class="n">ksi</span><span class="p">,</span><span class="n">eta</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">mat_phi</span><span class="p">,</span> <span class="n">mat_dphi</span></div>

<div class="viewcode-block" id="CrossSection"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection">[docs]</a><span class="k">class</span> <span class="nc">CrossSection</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class creates either a **beam** or a **pipe** cross-section object from input data. The **cross-section** defines the **structural element domain** and the Timoshenko theory makes use of several of its properties:</span>

<span class="sd">    ===================================  ============</span>
<span class="sd">           Property                       Definition</span>
<span class="sd">    ===================================  ============</span>
<span class="sd">    First moment of area in :math:`y`    :math:`Q_y = \\int_{A} y \mathrm{dA}`</span>
<span class="sd">    First moment of area in :math:`z`    :math:`Q_z = \\int_{A} z \mathrm{dA}`</span>
<span class="sd">    Second moment of area in :math:`y`   :math:`I_y = \\int_{A} y^2 \mathrm{dA}`</span>
<span class="sd">    Second moment of area in :math:`z`   :math:`I_z = \\int_{A} z^2 \mathrm{dA}`</span>
<span class="sd">    Second moment of area in :math:`yz`  :math:`I_{yz} = \\int_{A} yz \mathrm{dA}`</span>
<span class="sd">    Polar moment of area                 :math:`J = I_y + I_z`</span>
<span class="sd">    Centroid                             :math:`c = \\frac{1}{A}(Q_y, Q_z)`</span>
<span class="sd">    ===================================  ============</span>

<span class="sd">    Here, :math:`A` is the cross-section area. Those integrals area approximated by numeric integration when  or ``element_type = &#39;pipe_2&#39;``. Futhermore, these formulations approximates shear properties like the shear coefficients and the shear center coordinates :math:`c_s` by solving a Differential Problem within the section. On the other hand, when ``element_type = &#39;beam_1&#39;``, analytical approximation of each property is computed. The user is also allowed to provide the properties of any cross-section through the parameters ``self.area``, ``self.Iyy``, ``self.Izz``, ``self.Iyz``, and ``self.shear_coefficient``. From the acoustic point of view, the **pipes** element types also provide the acoustic cross-section area called ``self.fluid_area``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    element_type : [&#39;pipe_1&#39;,&#39;pipe_2&#39;,&#39;beam_1&#39;], optional</span>
<span class="sd">        Element type of the structural elements associated to the cross-section.</span>
<span class="sd">        Default is &#39;pipe_1&#39;.</span>

<span class="sd">    poisson_ratio : float, optional</span>
<span class="sd">        Poisson&#39;s ration of the material attributed to the structural elements. Only needed when ``element_type = &#39;pipe_1&#39;``.</span>
<span class="sd">        Default is 0.</span>

<span class="sd">    division_number : [8, 16, 32, 64, 128], optional</span>
<span class="sd">        Cross-section division number. This number is directly associated with the number of elements used in the process of approximating the cross-section shear properties. Only needed when ``element_type = &#39;pipe_1&#39;``.</span>
<span class="sd">        Default is 64.</span>
<span class="sd">    </span>
<span class="sd">    pipe_section_info : dict, optional</span>
<span class="sd">        Pipe section data is stored in a dictionary with the following structure ``{&quot;section_type_label&quot; : , &quot;section_parameters&quot; : }``. The paired value of ``&quot;section_type_label&quot;`` must be ``&quot;Pipe section&quot;`` due to internal and user interface propose. And the paired value of ``&quot;section_parameters&quot;`` is another dictionary with the structure ``{&quot;outer_diameter&quot; : , &quot;thickness&quot; : , &quot;offset_y&quot; : , &quot;offset_z&quot; : , &quot;insulation_thickness&quot; : , &quot;insulation_density&quot; : }``, and whose visual definitions and orientation can be seen in the :ref:`figure &lt;figPipe&gt;`. The expected values, its data types and descriptions are: ::</span>

<span class="sd">            &quot;outer_diameter&quot; : float</span>
<span class="sd">                Pipe outer diameter.</span>

<span class="sd">            &quot;thickness&quot; : float</span>
<span class="sd">                Pipe wall thickness.</span>

<span class="sd">            &quot;offset_y&quot; : float</span>
<span class="sd">                y coordinate of the pipe eccentricity offset.</span>

<span class="sd">            &quot;offset_z&quot; : float</span>
<span class="sd">                z coordinate of the pipe eccentricity offset.</span>

<span class="sd">            &quot;insulation_thickness&quot; : float</span>
<span class="sd">                Pipe insolation thickness.</span>

<span class="sd">            &quot;insulation_density&quot; : float</span>
<span class="sd">                Pipe insolation density.</span>
<span class="sd">        </span>
<span class="sd">        .. _figPipe:</span>

<span class="sd">        .. figure:: /figures/Pipe_section.svg</span>
<span class="sd">            :align: center</span>

<span class="sd">            Pipe section parameters and offset orientation.</span>

<span class="sd">    beam_section_info : dict, optional</span>
<span class="sd">        Beam section data is stored in a dictionary with the following structure ``{&quot;section_type_label&quot; : , &quot;section_parameters&quot; : , &quot;section_properties&quot; :}``. The supported paring ``str`` values of ``&quot;section_type_label&quot;`` are ``&#39;C-section&#39;, &#39;Circular section&#39;, &#39;I-section&#39;, &#39;Rectangular section&#39;, &#39;T-section&#39;``. And ``&quot;section_parameters&quot;`` is a list whose unwraping depends on the chosen beam section. For each section, it is shown up next the expected list structure.</span>
<span class="sd">        </span>
<span class="sd">        - **C-section** unwraps as follows ``h, w1, t1, w2, t2, tw, offset_y, offset_z = section_parameters``. Their visual definitions and orientation are presented in :ref:`figure &lt;figCsection&gt;`, and their data types and description are:</span>

<span class="sd">            ::</span>

<span class="sd">                h : float</span>
<span class="sd">                    Profile height.</span>

<span class="sd">                w1 : float</span>
<span class="sd">                    Upper profile width.</span>

<span class="sd">                t1 : float</span>
<span class="sd">                    Upper profile thickness.</span>

<span class="sd">                w2 : float</span>
<span class="sd">                    Lower profile width.</span>

<span class="sd">                t2 : float</span>
<span class="sd">                    Lower profile thickness.</span>

<span class="sd">                tw : float</span>
<span class="sd">                    Thickness.</span>

<span class="sd">                offset_y : float</span>
<span class="sd">                    y coordinate of the centroid offset.</span>

<span class="sd">                offset_z : float</span>
<span class="sd">                    z coordinate of the centroid offset.</span>
<span class="sd">            </span>
<span class="sd">            .. _figCsection:</span>

<span class="sd">            .. figure:: /figures/C_profile.svg</span>
<span class="sd">                :align: center</span>

<span class="sd">                C-section parameters and offset orientation.</span>
<span class="sd">        </span>
<span class="sd">        - **Circular section** unwraps as follows ``d_out, thickness, offset_y, offset_z = section_parameters``. Their visual definitions and orientation are presented in :ref:`figure &lt;figCircularsection&gt;`, and their data types and description are:</span>

<span class="sd">            ::</span>

<span class="sd">                d_out : float</span>
<span class="sd">                    External diameter.</span>

<span class="sd">                thickness : float</span>
<span class="sd">                    Thickness.</span>

<span class="sd">                offset_y : float</span>
<span class="sd">                    y coordinate of the centroid offset.</span>

<span class="sd">                offset_z : float</span>
<span class="sd">                    z coordinate of the centroid offset.</span>
<span class="sd">            </span>
<span class="sd">            .. _figCircularsection:</span>

<span class="sd">            .. figure:: /figures/Circular.svg</span>
<span class="sd">                :align: center</span>

<span class="sd">                Circular section parameters and offset orientation.</span>
<span class="sd">        </span>
<span class="sd">        - **I-section** unwraps as follows ``h, w1, t1, w2, t2, tw, offset_y, offset_z = section_parameters``. Their visual definitions and orientation are presented in :ref:`figure &lt;figIsection&gt;`, and their data types and description are:</span>

<span class="sd">            ::</span>

<span class="sd">                h : float</span>
<span class="sd">                    Profile height.</span>

<span class="sd">                w1 : float</span>
<span class="sd">                    Upper profile width.</span>

<span class="sd">                t1 : float</span>
<span class="sd">                    Upper profile thickness.</span>

<span class="sd">                w2 : float</span>
<span class="sd">                    Lower profile width.</span>

<span class="sd">                t2 : float</span>
<span class="sd">                    Lower profile thickness.</span>

<span class="sd">                tw : float</span>
<span class="sd">                    Thickness.</span>

<span class="sd">                offset_y : float</span>
<span class="sd">                    y coordinate of the centroid offset.</span>

<span class="sd">                offset_z : float</span>
<span class="sd">                    z coordinate of the centroid offset.</span>
<span class="sd">            </span>
<span class="sd">            .. _figIsection:</span>

<span class="sd">            .. figure:: /figures/I_profile.svg</span>
<span class="sd">                :align: center</span>

<span class="sd">                I-section parameters and offset orientation.</span>
<span class="sd">        </span>
<span class="sd">        - **T-section** unwraps as follows ``h, w1, t1, tw, offset_y, offset_z = section_parameters``. Their visual definitions and orientation are presented in :ref:`figure &lt;figTsection&gt;`, and their data types and description are:</span>

<span class="sd">            ::</span>

<span class="sd">                h : float</span>
<span class="sd">                    Profile height.</span>

<span class="sd">                w1 : float</span>
<span class="sd">                    Upper profile width.</span>

<span class="sd">                t1 : float</span>
<span class="sd">                    Upper profile thickness.</span>

<span class="sd">                tw : float</span>
<span class="sd">                    Thickness.</span>

<span class="sd">                offset_y : float</span>
<span class="sd">                    y coordinate of the centroid offset.</span>

<span class="sd">                offset_z : float</span>
<span class="sd">                    z coordinate of the centroid offset.</span>
<span class="sd">            </span>
<span class="sd">            .. _figTsection:</span>

<span class="sd">            .. figure:: /figures/T_profile.svg</span>
<span class="sd">                :align: center</span>

<span class="sd">                T-section parameters and offset orientation.</span>

<span class="sd">    valve_section_info : dict, optional</span>
<span class="sd">        Valve section data is stored in a dictionary with the following structure ``{&quot;section_type_label&quot; : , &quot;section_parameters&quot; : }``. The paired value of ``&quot;section_type_label&quot;`` must be ``&quot;Valve section&quot;`` due to internal and user interface propose. And the paired value of ``&quot;section_parameters&quot;`` is another dictionary with the structure ``{&quot;outer_diameter&quot; : , &quot;thickness&quot; : , &quot;offset_y&quot; : , &quot;offset_z&quot; : , &quot;insulation_thickness&quot; : , &quot;insulation_density&quot; : }``, and whose visual definitions and orientation is the same as seen in the :ref:`figure &lt;figPipe&gt;` for the Pipe section. The expected values, its data types and descriptions are: ::</span>

<span class="sd">            &quot;outer_diameter&quot; : float</span>
<span class="sd">                Pipe outer diameter.</span>

<span class="sd">            &quot;thickness&quot; : float</span>
<span class="sd">                Pipe wall thickness.</span>

<span class="sd">            &quot;offset_y&quot; : float</span>
<span class="sd">                y coordinate of the pipe eccentricity offset.</span>

<span class="sd">            &quot;offset_z&quot; : float</span>
<span class="sd">                z coordinate of the pipe eccentricity offset.</span>

<span class="sd">            &quot;insulation_thickness&quot; : float</span>
<span class="sd">                Pipe insolation thickness.</span>

<span class="sd">            &quot;insulation_density&quot; : float</span>
<span class="sd">                Pipe insolation density.</span>

<span class="sd">    generic_section_info : dict, optional</span>
<span class="sd">    </span>
<span class="sd">        [area, Iyy, Izz, Iyz, shear_factor, Yc, Zc] = data</span>

<span class="sd">        Valve section data is stored in a dictionary with the following structure ``{&quot;section_type_label&quot; : , &quot;section_parameters&quot; : }``. The paired value of ``&quot;section_type_label&quot;`` must be ``&quot;Valve section&quot;`` due to internal and user interface propose. And the paired value of ``&quot;section_parameters&quot;`` is another dictionary with the structure ``{&quot;outer_diameter&quot; : , &quot;thickness&quot; : , &quot;offset_y&quot; : , &quot;offset_z&quot; : , &quot;insulation_thickness&quot; : , &quot;insulation_density&quot; : }``, and whose visual definitions and orientation is the same as seen in the :ref:`figure &lt;figPipe&gt;` for the Pipe section. The expected values, its data types and descriptions are: ::</span>

<span class="sd">            &quot;area&quot; : float</span>
<span class="sd">                cross-section area.</span>

<span class="sd">            &quot;Yc&quot; : float</span>
<span class="sd">                y coordinate of the centroid.</span>

<span class="sd">            &quot;Zc&quot; : float</span>
<span class="sd">                z coordinate of the centroid.</span>

<span class="sd">            &quot;Iyy&quot; : float</span>
<span class="sd">                cross-section second moment of area with respect to the y direction.</span>

<span class="sd">            &quot;Izz&quot; : float</span>
<span class="sd">                cross-section second moment of area with respect to the z direction.</span>

<span class="sd">            &quot;Iyz&quot; : float</span>
<span class="sd">                cross-section second moment of area with respect to the yz plane.</span>

<span class="sd">            &quot;shear_coefficient&quot; : float</span>
<span class="sd">                cross-section shear coefficient.</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;division_number&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;element_type&#39;</span><span class="p">,</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poisson_ratio</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;poisson_ratio&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                
        <span class="c1"># Pipe section parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insulation_density</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset_virtual</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Beam section properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_moment_area_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_moment_area_z</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polar_moment_area</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_centroid</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_centroid</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shear_coefficient</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Shear properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_shear</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_shear</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_z</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># self.res_yz = 0</span>

        <span class="c1"># Principal Bending Axis Rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis_translation</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Input cluster data for pipe and beam sections </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipe_section_info</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pipe_section_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beam_section_info</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;beam_section_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_section_info</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;generic_section_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_info</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;expansion_joint_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valve_section_info</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;valve_section_info&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      
        <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;section_label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;section_parameters&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_plot_key</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Unwrap cluster data for pipe sections </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipe_section_info</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipe_section_info</span><span class="p">[</span><span class="s2">&quot;section_type_label&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipe_section_info</span><span class="p">[</span><span class="s2">&quot;section_parameters&quot;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;outer_diameter&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_y&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_z&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;insulation_thickness&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insulation_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;insulation_density&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipe_section_info</span>

        <span class="c1"># Unwrap cluster data for valve sections </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valve_section_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="s2">&quot;Valve section&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valve_section_info</span><span class="p">[</span><span class="s2">&quot;section_parameters&quot;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;outer_diameter&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_y&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_z&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;insulation_thickness&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insulation_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;insulation_density&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">section_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valve_section_info</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_info</span><span class="p">[</span><span class="s2">&quot;section_type_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter_to_plot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter_to_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valve_section_info</span><span class="p">[</span><span class="s2">&quot;diameters_to_plot&quot;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter_to_plot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter_to_plot</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="c1"># Unwrap cluster data for beam sections </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_section_info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_section_info</span><span class="p">[</span><span class="s2">&quot;section_type_label&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_section_info</span><span class="p">[</span><span class="s2">&quot;section_parameters&quot;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span> <span class="o">=</span> <span class="n">get_beam_section_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">section_info</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;section_type_label&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span>
                                   <span class="s2">&quot;section_parameters&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">,</span>
                                   <span class="s2">&quot;section_properties&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span>  <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Iyy&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Izz&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Iyz&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Yc&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Zc&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_section_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="s2">&quot;Generic section&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span> <span class="o">=</span> <span class="n">get_beam_section_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_section_info</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">section_info</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;section_type_label&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span>
                                   <span class="s2">&quot;section_parameters&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">,</span>
                                   <span class="s2">&quot;section_properties&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span>  <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Iyy&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Izz&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Iyz&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Yc&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Zc&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear_coefficient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;shear factor&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_plot_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outer_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:float: Cross-section outer radius</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span><span class="o">/</span><span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inner_diameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:float: Cross-section inner diameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inner_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:float: Cross-section inner radius</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter</span><span class="o">/</span><span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area_fluid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:float: Cross-section inner area, which corresponds to the acoustic domain cross-section area.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area_insulation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:float: Cross-section insulation area.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>

<div class="viewcode-block" id="CrossSection.mesh_connectivity"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.mesh_connectivity">[docs]</a>    <span class="k">def</span> <span class="nf">mesh_connectivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the tube cross mesh connectivity formed by Q9 (9-node quadrilateral element). The element-wise reference numbering follows the pattern: ::</span>

<span class="sd">                 y, r</span>
<span class="sd">                  ^</span>
<span class="sd">                  |</span>
<span class="sd">            2-----6-----3</span>
<span class="sd">            |           |</span>
<span class="sd">            |           |</span>
<span class="sd">            5     8     7 --&gt; x, θ</span>
<span class="sd">            |           |</span>
<span class="sd">            |           |</span>
<span class="sd">            1-----4-----0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (N, 9) array</span>
<span class="sd">            Connectivity of the tube cross mesh, where ``N = self.division_number``.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        mesh_coordinate : Nodal coordinates of the tube cross mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">connectivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">)</span>
        <span class="n">connectivity</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="n">ind</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">connectivity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">aux</span><span class="p">,</span><span class="n">aux</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="o">+</span><span class="n">aux</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">aux</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">aux</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="n">aux</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="n">connectivity</span>
        <span class="k">return</span> <span class="n">connectivity</span></div>
    
<div class="viewcode-block" id="CrossSection.mesh_coordinate"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.mesh_coordinate">[docs]</a>    <span class="k">def</span> <span class="nf">mesh_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns nodal coordinates of the tube cross mesh formed by Q9 (9-node quadrilateral element). The node coordinates and global numbering are created following the pattern: ::</span>

<span class="sd">                 y, r</span>
<span class="sd">                  ^</span>
<span class="sd">                  |</span>
<span class="sd">            0-----3      N-3</span>
<span class="sd">            |     |      |</span>
<span class="sd">            |     |      |</span>
<span class="sd">            1     4 ...  N-2   --&gt; x, θ</span>
<span class="sd">            |     |      |</span>
<span class="sd">            |     |      |</span>
<span class="sd">            2-----5      N-1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (N, 2) array</span>
<span class="sd">            Nodal coordinates of the tube cross mesh. Here, ``N = 6*self.division_number`` because each element has 9 nodes, but it shares 3 nodes with each neighbor element. The ``i``-th row has the ``(x, y)`` coordinates of the ``i``-th node.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        mesh_connectivity : Connectivity of the tube cross mesh.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># coordinates of points on the face</span>
        <span class="n">r_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">r_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_virtual</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_virtual</span> <span class="c1"># used in element_type = &#39;pipe_1&#39;</span>

        <span class="n">angular_increment</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">)</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span> <span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">aux</span><span class="o">*</span><span class="n">angular_increment</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">aux</span>
                    
        <span class="bp">self</span><span class="o">.</span><span class="n">number_nodes</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span>
        <span class="n">coordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">number_nodes</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_o</span> <span class="o">*</span> <span class="n">cossine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_o</span> <span class="o">*</span> <span class="n">sine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_o</span> <span class="o">+</span> <span class="n">r_i</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cossine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_o</span> <span class="o">+</span> <span class="n">r_i</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_i</span> <span class="o">*</span> <span class="n">cossine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">coordinate</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_i</span> <span class="o">*</span> <span class="n">sine</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">coordinate</span></div>
    
<div class="viewcode-block" id="CrossSection.preprocessing"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.preprocessing">[docs]</a>    <span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method process the cross-section mesh to generate in advance the arrays necessary to compute the section&#39;s shear properties. The arrays have the dimension of the total number of integration points ``N = N_int_points*self.division_number``, where ``N_int_points = 4`` is standard in OpenPulse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        el_type : [&#39;pipe_1&#39;,&#39;pipe_2&#39;], optional</span>
<span class="sd">            Element type of the structural elements attributed to the tube.</span>
<span class="sd">            Default is &#39;pipe_1&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        jac : (N, 2, 2) array</span>
<span class="sd">            Jacobian matrix of each integration point. It&#39;s a 3D matrix such that ``jac[p,:,:]`` is the Jacobian matrix of the ``p``-th integration point (2-by-2 matrix).</span>

<span class="sd">        inv_jac : (N, 2, 2) array</span>
<span class="sd">            Inverse of the Jacobian matrix of integration point. It&#39;s a 3D matrix such that ``inv_jac[p,:,:]`` is the inverse of the Jacobian matrix of the ``p``-th integration point (2-by-2 matrix).</span>

<span class="sd">        dA : (N,) array</span>
<span class="sd">            Differential of area of each integration point.</span>

<span class="sd">        y : (N,) array</span>
<span class="sd">            `y`-coordinate in the global coordinate system of each integration point.</span>

<span class="sd">        z : (N,) array</span>
<span class="sd">            `z`-coordinate in the global coordinate system of each integration point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="o">*</span><span class="n">N_int_points</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">_gauss_quadrature2D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_connectivity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_phi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_dphi</span> <span class="o">=</span> <span class="n">_get_all_shape_functions</span><span class="p">()</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_phi</span>
        <span class="n">dphi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_dphi</span>

        <span class="k">if</span> <span class="n">el_type</span> <span class="o">==</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">:</span>
            <span class="c1"># for the pipe_1 element, offset and its dependence need to be updated</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_virtual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_centroid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_centroid</span><span class="p">])</span> 
            <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_coordinate</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_coordinate</span><span class="p">()</span>
        
        <span class="c1"># Preallocating the variables</span>
        <span class="n">jac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">inv_jac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

        <span class="n">ind</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span> <span class="p">):</span> <span class="c1"># Integration over each element</span>
            <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span><span class="p">[</span><span class="n">el</span><span class="p">,:]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_int_points</span><span class="p">):</span>   <span class="c1"># integration points</span>
                <span class="n">jac</span><span class="p">[</span><span class="n">ind</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">dphi</span><span class="p">[</span><span class="n">k</span><span class="p">,:,:]</span><span class="nd">@coordinate</span><span class="p">[</span><span class="n">indexes</span><span class="p">,:]</span>
                <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="nd">@coordinate</span><span class="p">[</span><span class="n">indexes</span><span class="p">,:]</span>
                <span class="n">inv_jac</span><span class="p">[</span><span class="n">ind</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">jac</span><span class="p">[</span><span class="n">ind</span><span class="p">,:,:])</span>
                <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">jac</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">detjac</span> <span class="o">=</span> <span class="p">(</span><span class="n">aux</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">aux</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">aux</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">aux</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">jac</span><span class="p">,</span> <span class="n">inv_jac</span><span class="p">,</span> <span class="n">detjac</span><span class="o">*</span><span class="n">weight</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span></div>
            
<div class="viewcode-block" id="CrossSection.area_properties"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.area_properties">[docs]</a>    <span class="k">def</span> <span class="nf">area_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the tube cross area properties: area ``self.area``, first moment of area relative to y ``self.first_moment_area_y``, first moment of area relative to z ``self.first_moment_area_z``, second moment of area relative to y ``self.second_moment_area_y``, second moment of area relative to z ``self.second_moment_area_z``, second moment of area relative to yz ``self.second_moment_area_yz``, second polar moment of area ``self.polar_moment_area``, and centroid coordinate ``(self.y_centroid, self.z_centroid)``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        el_type : [&#39;pipe_1&#39;,&#39;pipe_2&#39;,&#39;beam_1&#39;]</span>
<span class="sd">            Element type of the structural elements attributed to the tube or beam.</span>
<span class="sd">            Default is &#39;pipe_1&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_jac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">(</span><span class="n">el_type</span> <span class="o">=</span> <span class="n">el_type</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">)</span>
        <span class="n">Iy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">))</span>
        <span class="n">Iz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">))</span>
        <span class="n">Iyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">))</span>
        <span class="n">Qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">)</span>
        <span class="n">Qz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_moment_area_y</span> <span class="o">=</span> <span class="n">Qy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_moment_area_z</span> <span class="o">=</span> <span class="n">Qz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> <span class="o">=</span> <span class="n">Iy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span> <span class="o">=</span> <span class="n">Iz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span> <span class="o">=</span> <span class="n">Iyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polar_moment_area</span> <span class="o">=</span> <span class="n">Iy</span> <span class="o">+</span> <span class="n">Iz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_centroid</span> <span class="o">=</span> <span class="n">Qz</span><span class="o">/</span><span class="n">A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_centroid</span> <span class="o">=</span> <span class="n">Qy</span><span class="o">/</span><span class="n">A</span></div>

<div class="viewcode-block" id="CrossSection.assembly_indexes"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.assembly_indexes">[docs]</a>    <span class="k">def</span> <span class="nf">assembly_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates rows and columns index maps used in the assembly process. ``self.rows_ind`` and ``self.cols_ind`` are **(N,) arrays** that map all degrees of freedom onto the respective row and column of the system&#39;s global matrix. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">cols_dofs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span>
        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">cols_dofs</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">cols_dofs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="nd">@np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">cols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rows_ind</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols_ind</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>
                            
<div class="viewcode-block" id="CrossSection.shear_properties"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.shear_properties">[docs]</a>    <span class="k">def</span> <span class="nf">shear_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poisson_ratio</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the tube cross shear properties shear coefficients ``self.res_y``, ``self.res_z`` and ``self.res_yz``, and shear center coordinates ``(self.y_shear, self.z_shear)``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        poisson_ratio : float, optional</span>
<span class="sd">            Poisson&#39;s ration of the material attributed to the tube.</span>
<span class="sd">            Default is 0.</span>

<span class="sd">        el_type : [&#39;pipe_1&#39;,&#39;pipe_2&#39;,&#39;beam_1&#39;], optional</span>
<span class="sd">            Element type of the structural elements attributed to the tube.</span>
<span class="sd">            Default is &#39;pipe_1&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area_properties</span><span class="p">(</span><span class="n">el_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assembly_indexes</span><span class="p">()</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_phi</span>
        <span class="n">dphi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_dphi</span>

        <span class="n">inv_jac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv_jac</span>
        <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span>
        <span class="n">dA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dA</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
        <span class="n">Iy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> 
        <span class="n">Iz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span>
        <span class="n">Iyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span>

        <span class="n">NGL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_nodes</span><span class="c1">#*DOFS_PER_NODE</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="o">*</span><span class="n">N_int_points</span>

        <span class="c1"># Shear Coefficients</span>
        <span class="n">Fy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NGL</span><span class="p">)</span>
        <span class="n">Fz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NGL</span><span class="p">)</span>
        <span class="n">FT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NGL</span><span class="p">)</span>
        <span class="c1"># </span>
        <span class="n">matrix_aux2</span> <span class="o">=</span>   <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Iy</span><span class="p">,</span> <span class="o">-</span><span class="n">Iyz</span><span class="p">],[</span><span class="n">Iyz</span><span class="p">,</span> <span class="n">Iy</span><span class="p">]])</span>
        <span class="n">matrix_aux3</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Iyz</span><span class="p">,</span> <span class="o">-</span><span class="n">Iz</span><span class="p">],[</span><span class="n">Iz</span><span class="p">,</span> <span class="n">Iyz</span><span class="p">]])</span>
        <span class="n">mat_aux_dphi</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="nd">@dphi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">aux_dphi</span> <span class="o">=</span> <span class="n">mat_aux_dphi</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
        <span class="n">mat_aux_phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="nd">@phi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">aux_phi</span> <span class="o">=</span> <span class="n">mat_aux_phi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">vec_dA</span> <span class="o">=</span> <span class="n">vec</span><span class="o">*</span><span class="n">dA</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">vector_aux</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">add_y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">poisson_ratio</span><span class="p">)</span><span class="o">*</span><span class="n">aux_phi</span><span class="o">*</span><span class="p">(</span><span class="n">Iy</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">Iyz</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">add_z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">poisson_ratio</span><span class="p">)</span><span class="o">*</span><span class="n">aux_phi</span><span class="o">*</span><span class="p">(</span><span class="n">Iz</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">Iyz</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">matrix_aux2</span><span class="nd">@vector_aux</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">matrix_aux3</span><span class="nd">@vector_aux</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dphig</span> <span class="o">=</span> <span class="n">inv_jac</span><span class="nd">@aux_dphi</span>
        <span class="n">dphig_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">dphig</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> 
        <span class="n">mat_ke</span> <span class="o">=</span> <span class="p">(</span><span class="n">dphig_T</span><span class="nd">@dphig</span><span class="p">)</span><span class="o">*</span><span class="n">dA</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data_ke</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">division_number</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span> <span class="p">):</span> <span class="c1"># Integration over each cross-sections element</span>
            <span class="n">Ke</span> <span class="o">=</span>  <span class="mi">0</span>
            <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span><span class="p">[</span><span class="n">el</span><span class="p">,:]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_int_points</span><span class="p">):</span>
                <span class="n">Ke</span> <span class="o">+=</span> <span class="n">mat_ke</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span>
                <span class="n">Fy</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">poisson_ratio</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dphig_T</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">@</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">add_y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">dA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">Fz</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">poisson_ratio</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dphig_T</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">@</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">add_z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">dA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">FT</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">dphig_T</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">@</span> <span class="n">vec_dA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data_ke</span><span class="p">[</span><span class="n">el</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">Ke</span>
        <span class="n">K_lg</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data_ke</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows_ind</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols_ind</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">NGL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NGL</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
                                            
        <span class="c1"># Pseudo inverse used to remedy numerical instability</span>
        <span class="n">inv_K_lg</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">K_lg</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>

        <span class="n">u2</span> <span class="o">=</span> <span class="n">inv_K_lg</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">u3</span> <span class="o">=</span> <span class="n">inv_K_lg</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fz</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">psi_y</span> <span class="o">=</span> <span class="n">u2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">psi_z</span> <span class="o">=</span> <span class="n">u3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d_poisson</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">poisson_ratio</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">h_poisson</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">poisson_ratio</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">dA</span> <span class="o">=</span> <span class="n">dA</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mat_dptemp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="n">mat_hptemp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

        <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">alpha_y</span> <span class="o">=</span> <span class="n">alpha_z</span> <span class="o">=</span> <span class="n">alpha_yz</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">division_number</span> <span class="p">):</span> <span class="c1"># Integration over each cross </span>
            <span class="n">indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span><span class="p">[</span><span class="n">el</span><span class="p">,:]</span>
            <span class="n">Np</span> <span class="o">=</span> <span class="n">N_int_points</span><span class="o">*</span><span class="n">el</span>
            <span class="n">mat_dptemp</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dphig</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:,:]</span> <span class="o">@</span> <span class="n">psi_y</span><span class="p">[</span><span class="n">indexes</span><span class="p">])</span> <span class="o">-</span> <span class="n">d_poisson</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:]</span>
            <span class="n">mat_hptemp</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dphig</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:,:]</span> <span class="o">@</span> <span class="n">psi_z</span><span class="p">[</span><span class="n">indexes</span><span class="p">])</span> <span class="o">-</span> <span class="n">h_poisson</span><span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">Np</span><span class="p">:</span><span class="mi">4</span><span class="o">+</span><span class="n">Np</span><span class="p">,:]</span>
        
        <span class="n">alpha_y</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">mat_dptemp</span><span class="o">*</span><span class="n">mat_dptemp</span><span class="o">*</span><span class="n">dA</span> <span class="p">)</span>
        <span class="n">alpha_z</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">mat_hptemp</span><span class="o">*</span><span class="n">mat_hptemp</span><span class="o">*</span><span class="n">dA</span> <span class="p">)</span>
        <span class="n">alpha_yz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">mat_dptemp</span><span class="o">*</span><span class="n">mat_hptemp</span><span class="o">*</span><span class="n">dA</span> <span class="p">)</span>
        
        <span class="n">ccg</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">poisson_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Iy</span><span class="o">*</span><span class="n">Iz</span> <span class="o">-</span> <span class="p">(</span><span class="n">Iyz</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">A_ccg2</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">ccg</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">res_y</span> <span class="o">=</span> <span class="n">A_ccg2</span><span class="o">*</span><span class="p">(</span><span class="n">alpha_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_z</span> <span class="o">=</span> <span class="n">A_ccg2</span><span class="o">*</span><span class="p">(</span><span class="n">alpha_z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_yz</span> <span class="o">=</span> <span class="n">A_ccg2</span><span class="o">*</span><span class="p">(</span><span class="n">alpha_yz</span><span class="p">)</span>

        <span class="c1"># shear center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_shear</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">psi_z</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">FT</span><span class="p">)</span><span class="o">/</span><span class="n">ccg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_shear</span> <span class="o">=</span> <span class="p">(</span><span class="n">psi_y</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">FT</span><span class="p">)</span><span class="o">/</span><span class="n">ccg</span></div>

<div class="viewcode-block" id="CrossSection.offset_rotation"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.offset_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">offset_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates the tube cross-section rotation due to the shear effects and eccentricity offset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        el_type : [&#39;pipe_1&#39;,&#39;pipe_2&#39;,&#39;beam_1&#39;], optional</span>
<span class="sd">            Element type of the structural elements attributed to the tube.</span>
<span class="sd">            Default is &#39;pipe_1&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">el_type</span> <span class="o">==</span> <span class="s1">&#39;pipe_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">el_type</span> <span class="o">==</span> <span class="s1">&#39;beam_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_shear</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_shear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_beam_shear_center</span><span class="p">()</span>
            <span class="n">y_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_centroid</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">z_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_centroid</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
            <span class="n">y_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_shear</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">z_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_shear</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_centroid</span>
            <span class="n">z_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_centroid</span>
            <span class="n">y_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_shear</span>
            <span class="n">z_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_shear</span>

        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Iy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_y</span> 
            <span class="n">Iz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_z</span>
            <span class="n">Iyz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_moment_area_yz</span>
            <span class="k">if</span> <span class="n">Iz</span><span class="o">==</span><span class="n">Iy</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Iyz</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">angle</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
                <span class="k">elif</span> <span class="n">Iyz</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">angle</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">angle</span> <span class="o">=</span> <span class="n">atan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Iyz</span><span class="o">/</span><span class="p">(</span><span class="n">Iz</span><span class="o">-</span><span class="n">Iy</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
            <span class="c1"># Rotational part of transformation matrix</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span> <span class="p">,</span>      <span class="mf">0.</span>   <span class="p">,</span>    <span class="mf">0.</span>    <span class="p">],</span>
                                <span class="p">[</span> <span class="mf">0.</span> <span class="p">,</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="p">,</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)],</span>
                                <span class="p">[</span> <span class="mf">0.</span> <span class="p">,</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)]])</span>
            <span class="c1"># Translational part of transformation matrix</span>
            <span class="n">translation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span>  <span class="p">,</span> <span class="n">z_c</span><span class="p">,</span><span class="o">-</span><span class="n">y_c</span><span class="p">],</span>
                                    <span class="p">[</span><span class="o">-</span><span class="n">z_s</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">],</span>
                                    <span class="p">[</span><span class="n">y_s</span> <span class="p">,</span>  <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">]])</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>   <span class="o">=</span> <span class="n">translation</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>  <span class="o">=</span> <span class="n">translation</span>
            <span class="c1">#</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis_translation</span> <span class="o">=</span> <span class="n">T</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis</span> <span class="o">=</span> <span class="n">R</span> <span class="o">@</span> <span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">translation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span>  <span class="p">,</span> <span class="n">z_c</span><span class="p">,</span><span class="o">-</span><span class="n">y_c</span><span class="p">],</span>
                                    <span class="p">[</span><span class="o">-</span><span class="n">z_s</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">],</span>
                                    <span class="p">[</span><span class="n">y_s</span> <span class="p">,</span>  <span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span>  <span class="p">]])</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis_rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>   <span class="o">=</span> <span class="n">translation</span>
            <span class="n">T</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>  <span class="o">=</span> <span class="n">translation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis_translation</span> <span class="o">=</span> <span class="n">T</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">principal_axis</span> <span class="o">=</span> <span class="n">T</span></div>

<div class="viewcode-block" id="CrossSection.update_properties"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.CrossSection.update_properties">[docs]</a>    <span class="k">def</span> <span class="nf">update_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method updates all the tube cross-section properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.area_properties(None)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear_properties</span><span class="p">(</span><span class="n">poisson_ratio</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">offset_rotation</span><span class="p">(</span><span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear_properties</span><span class="p">(</span><span class="n">poisson_ratio</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">el_type</span> <span class="o">=</span> <span class="s1">&#39;pipe_1&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shear_properties</span><span class="p">(</span><span class="n">poisson_ratio</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">poisson_ratio</span><span class="p">,</span> <span class="n">el_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">)</span></div>
    
    <span class="c1">## Beam related methods</span>
    <span class="k">def</span> <span class="nf">get_beam_shear_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># This method returns the shear center coordinates relative to the centroid of the cross-section.</span>

        <span class="c1"># Sections unwraping</span>

        <span class="c1"># self.section_label = &quot;I-section&quot;</span>
        <span class="c1"># self.section_parameters = [h, w1, t1, w2, t2, tw, offset_y, offset_z]</span>

        <span class="c1">#     h : float</span>
        <span class="c1">#         Height.</span>

        <span class="c1">#     w1 : float</span>
        <span class="c1">#         width.</span>

        <span class="c1">#     t1 : float</span>
        <span class="c1">#         thickness.</span>

        <span class="c1">#     w2 : float</span>
        <span class="c1">#         width.</span>

        <span class="c1">#     t2 : float</span>
        <span class="c1">#         thickness.</span>

        <span class="c1">#     tw : float</span>
        <span class="c1">#         thickness.</span>

        <span class="c1">#     offset_y : float</span>
        <span class="c1">#         offset in y-axis.</span>

        <span class="c1">#     offset_z : float</span>
        <span class="c1">#         offset in y-axis.</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Rectangular section&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Circular section&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;C-section&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>

            <span class="n">b1</span> <span class="o">=</span> <span class="n">w1</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span>

            <span class="n">kw</span> <span class="o">=</span> <span class="n">tw</span><span class="o">/</span><span class="n">t1</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">/</span><span class="n">t1</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="mf">1e-8</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">t1</span>
            <span class="n">tw</span> <span class="o">=</span> <span class="n">kw</span><span class="o">*</span><span class="n">t1</span>

            <span class="n">y1</span> <span class="o">=</span> <span class="n">b1</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="n">b2</span><span class="o">/</span><span class="mi">2</span>
            <span class="n">y3</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">z1</span> <span class="o">=</span> <span class="n">h</span>
            <span class="n">z2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">z3</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>

            <span class="n">A1</span> <span class="o">=</span> <span class="n">b1</span><span class="o">*</span><span class="n">t1</span>
            <span class="n">A2</span> <span class="o">=</span> <span class="n">b2</span><span class="o">*</span><span class="n">t2</span>
            <span class="n">A3</span> <span class="o">=</span> <span class="n">tw</span><span class="o">*</span><span class="n">h</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span> <span class="o">+</span> <span class="n">A3</span>

            <span class="n">yc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">y2</span><span class="o">*</span><span class="n">A2</span> <span class="o">+</span> <span class="n">y3</span><span class="o">*</span><span class="n">A3</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>
            <span class="n">zc</span> <span class="o">=</span> <span class="p">(</span><span class="n">z1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">z2</span><span class="o">*</span><span class="n">A2</span> <span class="o">+</span> <span class="n">z3</span><span class="o">*</span><span class="n">A3</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>

            <span class="n">Iyy_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyy_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">t2</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyy_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z3</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Iyy</span> <span class="o">=</span> <span class="n">Iyy_1</span> <span class="o">+</span> <span class="n">Iyy_2</span> <span class="o">+</span> <span class="n">Iyy_3</span>

            <span class="n">Izz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">b1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Izz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">t2</span><span class="o">*</span><span class="p">(</span><span class="n">b2</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Izz_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y3</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Izz</span> <span class="o">=</span> <span class="n">Izz_1</span> <span class="o">+</span> <span class="n">Izz_2</span> <span class="o">+</span> <span class="n">Izz_3</span>

            <span class="n">Iyz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyz_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z3</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Iyz</span> <span class="o">=</span> <span class="n">Iyz_1</span> <span class="o">+</span> <span class="n">Iyz_2</span> <span class="o">+</span> <span class="n">Iyz_3</span>

            <span class="n">F1_Vz</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">b1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">Iyy</span><span class="o">*</span><span class="n">Izz</span><span class="o">-</span><span class="n">Iyz</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">Iyz</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">b1</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">yc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">Izz</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">zc</span><span class="p">))</span>
            <span class="n">F1_Vy</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">b1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">Iyy</span><span class="o">*</span><span class="n">Izz</span><span class="o">-</span><span class="n">Iyz</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">Iyy</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">b1</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">yc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">Iyz</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">zc</span><span class="p">))</span>

            <span class="n">e_y</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">F1_Vz</span>
            <span class="n">e_z</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">F1_Vy</span>
            
            <span class="k">return</span> <span class="n">e_y</span><span class="p">,</span> <span class="n">e_z</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;I-section&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>

            <span class="n">b1</span> <span class="o">=</span> <span class="n">w1</span>
            <span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span>

            <span class="n">kw</span> <span class="o">=</span> <span class="n">tw</span><span class="o">/</span><span class="n">t1</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">/</span><span class="n">t1</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="mf">1e-8</span>
            <span class="n">t2</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="n">t1</span>
            <span class="n">tw</span> <span class="o">=</span> <span class="n">kw</span><span class="o">*</span><span class="n">t1</span>

            <span class="n">y1</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">y3</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">z1</span> <span class="o">=</span> <span class="n">h</span>
            <span class="n">z2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">z3</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>

            <span class="n">A1</span> <span class="o">=</span> <span class="n">b1</span><span class="o">*</span><span class="n">t1</span>
            <span class="n">A2</span> <span class="o">=</span> <span class="n">b2</span><span class="o">*</span><span class="n">t2</span>
            <span class="n">A3</span> <span class="o">=</span> <span class="n">tw</span><span class="o">*</span><span class="n">h</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span> <span class="o">+</span> <span class="n">A3</span>

            <span class="n">yc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">y2</span><span class="o">*</span><span class="n">A2</span> <span class="o">+</span> <span class="n">y3</span><span class="o">*</span><span class="n">A3</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>
            <span class="n">zc</span> <span class="o">=</span> <span class="p">(</span><span class="n">z1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">z2</span><span class="o">*</span><span class="n">A2</span> <span class="o">+</span> <span class="n">z3</span><span class="o">*</span><span class="n">A3</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>

            <span class="n">Iyy_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyy_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">t2</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyy_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z3</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Iyy</span> <span class="o">=</span> <span class="n">Iyy_1</span> <span class="o">+</span> <span class="n">Iyy_2</span> <span class="o">+</span> <span class="n">Iyy_3</span>

            <span class="n">Izz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">b1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Izz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">t2</span><span class="o">*</span><span class="p">(</span><span class="n">b2</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Izz_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y3</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Izz</span> <span class="o">=</span> <span class="n">Izz_1</span> <span class="o">+</span> <span class="n">Izz_2</span> <span class="o">+</span> <span class="n">Izz_3</span>

            <span class="n">Iyz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyz_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z3</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A3</span>
            <span class="n">Iyz</span> <span class="o">=</span> <span class="n">Iyz_1</span> <span class="o">+</span> <span class="n">Iyz_2</span> <span class="o">+</span> <span class="n">Iyz_3</span>

            <span class="n">F1_Vy</span> <span class="o">=</span> <span class="p">((</span><span class="n">b1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">Izz</span><span class="p">))</span>
            <span class="c1"># F1_Vz = ((b1**2)*t1/(8*Iyy))*(h-zc)</span>

            <span class="n">e_y</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e_z</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">F1_Vy</span>

            <span class="k">return</span> <span class="n">e_y</span><span class="p">,</span> <span class="n">e_z</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;T-section&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>

            <span class="n">b1</span> <span class="o">=</span> <span class="n">w1</span>

            <span class="n">kw</span> <span class="o">=</span> <span class="n">tw</span><span class="o">/</span><span class="n">t1</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="mf">1e-8</span>
            <span class="n">kw</span> <span class="o">=</span> <span class="mi">1000</span>
            <span class="n">tw</span> <span class="o">=</span> <span class="n">kw</span><span class="o">*</span><span class="n">t1</span>

            <span class="n">y1</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">z1</span> <span class="o">=</span> <span class="n">h</span>
            <span class="n">z2</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>

            <span class="n">A1</span> <span class="o">=</span> <span class="n">b1</span><span class="o">*</span><span class="n">t1</span>
            <span class="n">A2</span> <span class="o">=</span> <span class="n">tw</span><span class="o">*</span><span class="n">h</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">A1</span> <span class="o">+</span> <span class="n">A2</span>

            <span class="n">yc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">y2</span><span class="o">*</span><span class="n">A2</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>
            <span class="n">zc</span> <span class="o">=</span> <span class="p">(</span><span class="n">z1</span><span class="o">*</span><span class="n">A1</span> <span class="o">+</span> <span class="n">z2</span><span class="o">*</span><span class="n">A2</span><span class="p">)</span><span class="o">/</span><span class="n">A</span>

            <span class="n">Iyy_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">b1</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyy_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyy</span> <span class="o">=</span> <span class="n">Iyy_1</span> <span class="o">+</span> <span class="n">Iyy_2</span>

            <span class="n">Izz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">b1</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Izz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Izz</span> <span class="o">=</span> <span class="n">Izz_1</span> <span class="o">+</span> <span class="n">Izz_2</span>

            <span class="n">Iyz_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
            <span class="n">Iyz_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">zc</span><span class="p">)</span><span class="o">*</span><span class="n">A2</span>
            <span class="n">Iyz</span> <span class="o">=</span> <span class="n">Iyz_1</span> <span class="o">+</span> <span class="n">Iyz_2</span>

            <span class="n">F1_Vy</span> <span class="o">=</span> <span class="p">((</span><span class="n">b1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">t1</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">Izz</span><span class="p">))</span>
            <span class="c1"># F1_Vz = ((b1**2)*t1/(8*Iyy))*(h-zc)</span>

            <span class="n">e_y</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e_z</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">F1_Vy</span>
     
            <span class="k">return</span> <span class="n">e_y</span><span class="p">,</span> <span class="n">e_z</span>
    
    <span class="k">def</span> <span class="nf">get_cross_section_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>

        <span class="n">inner_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Pipe section&quot;</span><span class="p">:</span> <span class="c1"># Pipe section - It&#39;s a pipe section, so ignore for beam plots</span>

            <span class="c1"># N = element.cross_section.division_number</span>
            <span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># temporary number of divisions for pipe sections</span>
 
            <span class="n">d_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter</span>
            <span class="n">d_in</span> <span class="o">=</span> <span class="n">d_out</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span>

            <span class="n">d_theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>
            <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            
            <span class="n">Y_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
            <span class="n">Y_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">Y_out</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
                <span class="n">Z_out</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>

            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
            <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Rectangular section&quot;</span><span class="p">:</span> <span class="c1"># Beam: Rectangular section</span>

            <span class="n">b</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">b_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>           
            <span class="c1"># Y_out = np.array([(b/2), (b/2), -(b/2), -(b/2), (b/2)]</span>
            <span class="c1"># Z_out = np.array([(h/2), -(h/2), -(h/2), (h/2), (h/2)]</span>
            <span class="n">Y_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>  <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span> <span class="o">+</span> <span class="n">offset_z</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">b_in</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Y_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>  <span class="o">-</span><span class="p">(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span> <span class="o">+</span> <span class="n">offset_y</span>
                <span class="n">Z_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span> <span class="o">+</span> <span class="n">offset_z</span>
                <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Circular section&quot;</span><span class="p">:</span> <span class="c1"># Beam: Circular section</span>
            
            <span class="n">N</span> <span class="o">=</span> <span class="mi">24</span><span class="c1"># element.cross_section.division_number</span>
            <span class="n">d_out</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>
            <span class="k">if</span> <span class="n">thickness</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d_in</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d_in</span> <span class="o">=</span> <span class="n">d_out</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">thickness</span>

            <span class="n">d_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>

            <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

            <span class="n">Y_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="n">offset_y</span> 
            <span class="n">Z_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="n">offset_z</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
                        
            <span class="k">if</span> <span class="n">d_in</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="n">Y_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="n">offset_y</span>
                <span class="n">Z_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="n">offset_z</span>
                <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s1">&#39;C-section&#39;</span><span class="p">:</span> <span class="c1"># Beam: C-section</span>

            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>
            <span class="n">Yp_out</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">Zp_out</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t2</span><span class="p">),</span> <span class="o">-</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t2</span><span class="p">),</span> <span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">),</span> <span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>

            <span class="n">Y_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Yp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Zp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_z</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s1">&#39;I-section&#39;</span><span class="p">:</span> <span class="c1"># Beam: I-section</span>

            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>
            <span class="n">Yp_out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
            <span class="n">Zp_out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t2</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
            
            <span class="n">Y_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Yp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Zp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_z</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
    
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s1">&#39;T-section&#39;</span><span class="p">:</span> <span class="c1"># Beam: T-section</span>

            <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span>
            <span class="n">Yp_out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
            <span class="n">Zp_out</span> <span class="o">=</span> <span class="p">[(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>

            <span class="n">Y_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Yp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Zp_out</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset_z</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
        
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Expansion joint section&quot;</span> <span class="p">:</span> <span class="c1">#</span>
    
            <span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># temporary number of divisions for pipe sections</span>
    
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_plot_key</span> <span class="o">==</span> <span class="s2">&quot;major&quot;</span><span class="p">:</span>
              <span class="n">r_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="mf">1.25</span> 
            
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">expansion_joint_plot_key</span> <span class="o">==</span> <span class="s2">&quot;minor&quot;</span><span class="p">:</span>
                <span class="n">r_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="mf">1.1</span>            
            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="mf">1.4</span>
            
            <span class="n">r_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="mf">0.8</span>

            <span class="n">d_theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>
            <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            
            <span class="n">Y_out</span> <span class="o">=</span> <span class="n">r_out</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="n">r_out</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
            <span class="n">Y_in</span> <span class="o">=</span> <span class="n">r_in</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_in</span> <span class="o">=</span> <span class="n">r_in</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
            
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
            <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Valve section&quot;</span> <span class="p">:</span> <span class="c1">#</span>
    
            <span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># temporary number of divisions for pipe sections</span>

            <span class="n">d_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_diameter_to_plot</span>
            <span class="n">d_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter_to_plot</span>
            <span class="c1"># d_in = d_out - 2*self.thickness</span>

            <span class="k">if</span> <span class="n">d_in</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d_in</span> <span class="o">=</span> <span class="mf">0.004</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inner_diameter_to_plot</span> <span class="o">=</span> <span class="n">d_in</span>

            <span class="n">d_theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>
            <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            
            <span class="n">Y_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>
            <span class="n">Y_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
            <span class="n">Z_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">Y_out</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_y</span>
                <span class="n">Z_out</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_z</span>

            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
            <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># A very small triangle to prevent bugs</span>
            <span class="n">Y_out</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">Z_out</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">]</span>
            <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>

        <span class="c1"># TODO: section_type == 6: creates an equivalent beam section</span>
        <span class="c1"># return outer_points, inner_points</span>

        <span class="k">if</span> <span class="n">inner_points</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="n">max_min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span> <span class="n">length</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y_in</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z_in</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Y_in</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Z_in</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">section_label</span><span class="p">,</span> <span class="n">length</span><span class="p">])</span>        
        
        <span class="k">return</span> <span class="n">outer_points</span><span class="p">,</span> <span class="n">inner_points</span><span class="p">,</span> <span class="n">max_min</span></div>

<div class="viewcode-block" id="get_circular_section_points"><a class="viewcode-back" href="../../../code_reference/CrossSection.html#pulse.preprocessing.cross_section.get_circular_section_points">[docs]</a><span class="k">def</span> <span class="nf">get_circular_section_points</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">section_label</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot; This method returns &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># temporary number of divisions for circular sections</span>
    
    <span class="k">if</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Expansion joint section&quot;</span><span class="p">:</span>

        <span class="n">d_out</span><span class="p">,</span> <span class="n">d_in</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">,</span> <span class="n">insulation_thickness</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">parameters</span>

        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;major&quot;</span><span class="p">:</span>
            <span class="n">d_out</span> <span class="o">*=</span> <span class="mf">1.25</span> 
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;minor&quot;</span><span class="p">:</span>
            <span class="n">d_out</span> <span class="o">*=</span> <span class="mf">1.1</span>            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_out</span> <span class="o">*=</span> <span class="mf">1.4</span>
            
    <span class="k">else</span><span class="p">:</span>

        <span class="n">d_out</span><span class="p">,</span> <span class="n">d_in</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">,</span> <span class="n">insulation_thickness</span> <span class="o">=</span> <span class="n">parameters</span>
    
    <span class="n">r_out</span> <span class="o">=</span> <span class="n">d_out</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">r_in</span> <span class="o">=</span> <span class="n">d_in</span><span class="o">/</span><span class="mi">2</span>
    
    <span class="n">d_theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>
    <span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">cossine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    
    <span class="n">Y_out</span> <span class="o">=</span> <span class="n">r_out</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="n">offset_y</span>
    <span class="n">Z_out</span> <span class="o">=</span> <span class="n">r_out</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="n">offset_z</span>
    <span class="n">Y_in</span> <span class="o">=</span> <span class="n">r_in</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="n">offset_y</span>
    <span class="n">Z_in</span> <span class="o">=</span> <span class="n">r_in</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">if</span> <span class="n">insulation_thickness</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">Y_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_out</span> <span class="o">+</span> <span class="n">insulation_thickness</span><span class="p">)</span><span class="o">*</span><span class="n">cossine</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Z_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_out</span> <span class="o">+</span> <span class="n">insulation_thickness</span><span class="p">)</span><span class="o">*</span><span class="n">sine</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="n">outer_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_out</span><span class="p">,</span> <span class="n">Z_out</span><span class="p">))</span>
    <span class="n">inner_points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Y_in</span><span class="p">,</span> <span class="n">Z_in</span><span class="p">))</span>

    <span class="n">max_min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Y_in</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Z_in</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Y_out</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Z_out</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Y_in</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">Z_in</span><span class="p">),</span> <span class="n">section_label</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">outer_points</span><span class="p">,</span> <span class="n">inner_points</span><span class="p">,</span> <span class="n">max_min</span></div>

<span class="k">def</span> <span class="nf">get_points_to_plot_section</span><span class="p">(</span><span class="n">section_label</span><span class="p">,</span> <span class="n">section_parameters</span><span class="p">):</span>   
    
    <span class="k">if</span> <span class="n">section_label</span> <span class="o">!=</span> <span class="s2">&quot;Pipe section&quot;</span><span class="p">:</span>

        <span class="n">section_properties</span> <span class="o">=</span> <span class="n">get_beam_section_properties</span><span class="p">(</span><span class="n">section_label</span><span class="p">,</span> <span class="n">section_parameters</span><span class="p">)</span>
        <span class="n">Yc</span> <span class="o">=</span> <span class="n">section_properties</span><span class="p">[</span><span class="s2">&quot;Yc&quot;</span><span class="p">]</span>
        <span class="n">Zc</span> <span class="o">=</span> <span class="n">section_properties</span><span class="p">[</span><span class="s2">&quot;Zc&quot;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="n">d_out</span> <span class="o">=</span> <span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;outer_diameter&quot;</span><span class="p">]</span>
        <span class="n">thickness</span> <span class="o">=</span> <span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;thickness&quot;</span><span class="p">]</span>
        <span class="n">offset_y</span> <span class="o">=</span> <span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_y&quot;</span><span class="p">]</span>
        <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;offset_z&quot;</span><span class="p">]</span>
        <span class="n">insulation_thickness</span> <span class="o">=</span> <span class="n">section_parameters</span><span class="p">[</span><span class="s2">&quot;insulation_thickness&quot;</span><span class="p">]</span>

        <span class="n">Yc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Zc</span> <span class="o">=</span> <span class="mi">0</span>    

        <span class="n">Yc_offset</span> <span class="o">=</span> <span class="n">Yc</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zc_offset</span> <span class="o">=</span> <span class="n">Zc</span> <span class="o">+</span> <span class="n">offset_z</span>

        <span class="n">d_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">d_theta</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>
        <span class="n">d_in</span> <span class="o">=</span> <span class="n">d_out</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">thickness</span>

        <span class="n">Yp_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Zp_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Yp_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Zp_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">Yp_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Yp_out</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Yp_in</span><span class="p">),[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">Zp_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Zp_out</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Zp_in</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)]]</span>

        <span class="n">Yp_right</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Yp_list</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>
        <span class="n">Zp_right</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Zp_list</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>

        <span class="n">Yp_left</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right</span><span class="p">)</span>
        <span class="n">Zp_left</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right</span><span class="p">)</span>
        
        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right</span><span class="p">,</span> <span class="n">Yp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right</span><span class="p">,</span> <span class="n">Zp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>
        
        <span class="k">if</span> <span class="n">insulation_thickness</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>

            <span class="n">Yp_out_ins</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">Zp_out_ins</span> <span class="o">=</span> <span class="p">((</span><span class="n">d_out</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">insulation_thickness</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">Yp_in_ins</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">Zp_in_ins</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>

            <span class="n">Yp_list_ins</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Yp_out_ins</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Yp_in_ins</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">Zp_list_ins</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Zp_out_ins</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Zp_in_ins</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)]]</span>

            <span class="n">Yp_right_ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Yp_list_ins</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>
            <span class="n">Zp_right_ins</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Zp_list_ins</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>

            <span class="n">Yp_left_ins</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right_ins</span><span class="p">)</span>
            <span class="n">Zp_left_ins</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right_ins</span><span class="p">)</span>

            <span class="n">Yp_ins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right_ins</span><span class="p">,</span> <span class="n">Yp_left_ins</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
            <span class="n">Zp_ins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right_ins</span><span class="p">,</span> <span class="n">Zp_left_ins</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>

            <span class="k">return</span> <span class="n">Yp</span><span class="p">,</span> <span class="n">Zp</span><span class="p">,</span> <span class="n">Yp_ins</span><span class="p">,</span> <span class="n">Zp_ins</span><span class="p">,</span> <span class="n">Yc_offset</span><span class="p">,</span> <span class="n">Zc_offset</span>
        <span class="k">return</span> <span class="n">Yp</span><span class="p">,</span> <span class="n">Zp</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Yc_offset</span><span class="p">,</span> <span class="n">Zc_offset</span>
            
    <span class="k">if</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Rectangular section&quot;</span><span class="p">:</span>

        <span class="n">b</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">b_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span>
            
        <span class="n">Yp_right</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">b_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Zp_right</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h_in</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>

        <span class="n">Yp_left</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right</span><span class="p">)</span>
        <span class="n">Zp_left</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right</span><span class="p">)</span>

        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right</span><span class="p">,</span> <span class="n">Yp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right</span><span class="p">,</span> <span class="n">Zp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Circular section&quot;</span><span class="p">:</span>

        <span class="n">N</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="n">d_out</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span>
        <span class="k">if</span> <span class="n">thickness</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">d_in</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d_in</span> <span class="o">=</span> <span class="n">d_out</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">thickness</span>
        
        <span class="n">d_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">N</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">d_theta</span><span class="p">,</span> <span class="n">d_theta</span><span class="p">)</span>

        <span class="n">Yp_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Zp_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Yp_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">Zp_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_in</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">Yp_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Yp_out</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Yp_in</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">Zp_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Zp_out</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">Zp_in</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">d_out</span><span class="o">/</span><span class="mi">2</span><span class="p">)]]</span>

        <span class="n">Yp_right</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Yp_list</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>
        <span class="n">Zp_right</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_list</span> <span class="ow">in</span> <span class="n">Zp_list</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">]</span>

        <span class="n">Yp_left</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right</span><span class="p">)</span>
        <span class="n">Zp_left</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right</span><span class="p">)</span>

        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right</span><span class="p">,</span> <span class="n">Yp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right</span><span class="p">,</span> <span class="n">Zp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;C-section&quot;</span><span class="p">:</span>

        <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span>
        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t2</span>

        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">offset_y</span> 
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;I-section&quot;</span><span class="p">:</span>

        <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span>
        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t2</span>

        <span class="n">Yp_right</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Zp_right</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t2</span><span class="p">),</span> <span class="o">-</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>

        <span class="n">Yp_left</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right</span><span class="p">)</span>
        <span class="n">Zp_left</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right</span><span class="p">)</span>

        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right</span><span class="p">,</span> <span class="n">Yp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right</span><span class="p">,</span> <span class="n">Zp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;T-section&quot;</span><span class="p">:</span>

        <span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span> <span class="o">=</span> <span class="n">section_parameters</span>
        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span>

        <span class="n">Yp_right</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">Zp_right</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t1</span><span class="p">,</span> <span class="p">(</span><span class="n">hw</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">t1</span><span class="p">]</span>

        <span class="n">Yp_left</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Yp_right</span><span class="p">)</span>
        <span class="n">Zp_left</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Zp_right</span><span class="p">)</span>

        <span class="n">Yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Yp_right</span><span class="p">,</span> <span class="n">Yp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_y</span>
        <span class="n">Zp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Zp_right</span><span class="p">,</span> <span class="n">Zp_left</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset_z</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Generic section&quot;</span><span class="p">:</span>

        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;The GENERIC BEAM SECTION cannot be ploted.&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Error while graphing cross-section&quot;</span>
        <span class="n">info_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">]</span>

        <span class="c1">#TODO: breaks execution of code</span>
        <span class="c1"># PrintMessageInput(info_text)</span>

        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    
    <span class="n">Yc</span> <span class="o">=</span> <span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Yc&#39;</span><span class="p">]</span>
    <span class="n">Zc</span> <span class="o">=</span> <span class="n">section_properties</span><span class="p">[</span><span class="s1">&#39;Zc&#39;</span><span class="p">]</span>

    <span class="n">Yc_offset</span> <span class="o">=</span> <span class="n">Yc</span> <span class="o">+</span> <span class="n">offset_y</span>
    <span class="n">Zc_offset</span> <span class="o">=</span> <span class="n">Zc</span> <span class="o">+</span> <span class="n">offset_z</span>    

    <span class="k">return</span> <span class="n">Yp</span><span class="p">,</span> <span class="n">Zp</span><span class="p">,</span> <span class="n">Yc_offset</span><span class="p">,</span> <span class="n">Zc_offset</span>

<span class="k">def</span> <span class="nf">get_beam_section_properties</span><span class="p">(</span><span class="n">section_label</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Generic section&quot;</span><span class="p">:</span>

        <span class="p">[</span><span class="n">area</span><span class="p">,</span> <span class="n">Iyy</span><span class="p">,</span> <span class="n">Izz</span><span class="p">,</span> <span class="n">Iyz</span><span class="p">,</span> <span class="n">shear_factor</span><span class="p">,</span> <span class="n">Yc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

        <span class="n">section_properties</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;area&quot;</span> <span class="p">:</span> <span class="n">area</span><span class="p">,</span> 
                                <span class="s2">&quot;Iyy&quot;</span> <span class="p">:</span> <span class="n">Iyy</span><span class="p">,</span> 
                                <span class="s2">&quot;Izz&quot;</span> <span class="p">:</span> <span class="n">Izz</span><span class="p">,</span> 
                                <span class="s2">&quot;Iyz&quot;</span> <span class="p">:</span> <span class="n">Iyz</span><span class="p">,</span> 
                                <span class="s2">&quot;Yc&quot;</span> <span class="p">:</span> <span class="n">Yc</span><span class="p">,</span> 
                                <span class="s2">&quot;Zc&quot;</span> <span class="p">:</span> <span class="n">Zc</span><span class="p">,</span>   
                                <span class="s2">&quot;shear_factor&quot;</span><span class="p">:</span> <span class="n">shear_factor</span>    <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">section_properties</span>

    <span class="k">if</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Rectangular section&quot;</span><span class="p">:</span>

        <span class="p">[</span><span class="n">base</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">base_in</span><span class="p">,</span> <span class="n">height_in</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        
        <span class="n">area</span> <span class="o">=</span> <span class="n">base</span><span class="o">*</span><span class="n">height</span> <span class="o">-</span> <span class="n">base_in</span><span class="o">*</span><span class="n">height_in</span>
        <span class="n">Iyy</span> <span class="o">=</span> <span class="p">((</span><span class="n">height</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">base</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">height_in</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">base_in</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">Izz</span> <span class="o">=</span> <span class="p">((</span><span class="n">base</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">height</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">base_in</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">height_in</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">Iyz</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">Yc</span><span class="p">,</span> <span class="n">Zc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    
    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;Circular section&quot;</span><span class="p">:</span>
        
        <span class="p">[</span><span class="n">outer_diameter_beam</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        
        <span class="k">if</span> <span class="n">thickness</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">inner_diameter_beam</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inner_diameter_beam</span> <span class="o">=</span> <span class="n">outer_diameter_beam</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">thickness</span>

        <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="n">outer_diameter_beam</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">inner_diameter_beam</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span>
        <span class="n">Iyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="n">outer_diameter_beam</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">inner_diameter_beam</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="mi">64</span>
        <span class="n">Izz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="n">outer_diameter_beam</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">inner_diameter_beam</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">/</span><span class="mi">64</span>
        <span class="n">Iyz</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Yc</span><span class="p">,</span> <span class="n">Zc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> 

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;C-section&quot;</span><span class="p">:</span>

        <span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t2</span>
        
        <span class="n">A_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="p">,</span> <span class="n">w2</span><span class="o">*</span><span class="n">t2</span><span class="p">])</span>
        <span class="n">A_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A_i</span><span class="p">)</span>

        <span class="n">y_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">w2</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">z_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([((</span><span class="n">t1</span><span class="o">+</span><span class="n">hw</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">((</span><span class="n">hw</span><span class="o">+</span><span class="n">t2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>
        
        <span class="n">I_yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">w2</span><span class="o">*</span><span class="n">t2</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">t1</span><span class="o">*</span><span class="n">w1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">hw</span><span class="o">*</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">t2</span><span class="o">*</span><span class="n">w2</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_yzi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;I-section&quot;</span><span class="p">:</span>

        <span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t2</span>
        
        <span class="n">A_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="p">,</span> <span class="n">w2</span><span class="o">*</span><span class="n">t2</span><span class="p">])</span>
        <span class="n">A_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A_i</span><span class="p">)</span>  

        <span class="n">y_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">z_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([((</span><span class="n">t1</span><span class="o">+</span><span class="n">hw</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">((</span><span class="n">hw</span><span class="o">+</span><span class="n">t2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span>

        <span class="n">I_yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">w2</span><span class="o">*</span><span class="n">t2</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">t1</span><span class="o">*</span><span class="n">w1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">hw</span><span class="o">*</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">t2</span><span class="o">*</span><span class="n">w2</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_yzi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">section_label</span> <span class="o">==</span> <span class="s2">&quot;T-section&quot;</span><span class="p">:</span>

        <span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">offset_y</span><span class="p">,</span> <span class="n">offset_z</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

        <span class="n">hw</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">t1</span>

        <span class="n">A_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="p">,</span> <span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="p">])</span>
        <span class="n">A_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A_i</span><span class="p">)</span>

        <span class="n">y_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">z_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([((</span><span class="n">t1</span><span class="o">+</span><span class="n">hw</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>

        <span class="n">I_yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">w1</span><span class="o">*</span><span class="n">t1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">tw</span><span class="o">*</span><span class="n">hw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">t1</span><span class="o">*</span><span class="n">w1</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="p">(</span><span class="n">hw</span><span class="o">*</span><span class="n">tw</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">I_yzi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  

    <span class="k">if</span> <span class="n">section_label</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;C-section&quot;</span><span class="p">,</span> <span class="s2">&quot;I-section&quot;</span><span class="p">,</span> <span class="s2">&quot;T-section&quot;</span><span class="p">]:</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">A_t</span>
        <span class="n">Yc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_ci</span><span class="nd">@A_i</span><span class="p">)</span><span class="o">/</span><span class="n">A_t</span>
        <span class="n">Zc</span> <span class="o">=</span> <span class="p">(</span><span class="n">z_ci</span><span class="nd">@A_i</span><span class="p">)</span><span class="o">/</span><span class="n">A_t</span>
        <span class="n">Iyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">I_yi</span> <span class="o">+</span> <span class="p">((</span><span class="n">z_ci</span><span class="o">-</span><span class="n">Zc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A_i</span><span class="p">)</span>
        <span class="n">Izz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">I_zi</span> <span class="o">+</span> <span class="p">((</span><span class="n">y_ci</span><span class="o">-</span><span class="n">Yc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A_i</span><span class="p">)</span>
        <span class="n">Iyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">I_yzi</span> <span class="o">+</span> <span class="p">((</span><span class="n">y_ci</span><span class="o">-</span><span class="n">Yc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z_ci</span><span class="o">-</span><span class="n">Zc</span><span class="p">))</span><span class="o">*</span><span class="n">A_i</span><span class="p">)</span>
    
    <span class="n">section_properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">area</span><span class="p">,</span> <span class="n">Iyy</span><span class="p">,</span> <span class="n">Izz</span><span class="p">,</span> <span class="n">Iyz</span><span class="p">,</span> <span class="n">Yc</span><span class="p">,</span> <span class="n">Zc</span><span class="p">]</span>

    <span class="n">section_properties</span> <span class="o">=</span> <span class="p">{</span>  <span class="s2">&quot;area&quot;</span> <span class="p">:</span> <span class="n">area</span><span class="p">,</span> 
                            <span class="s2">&quot;Iyy&quot;</span> <span class="p">:</span> <span class="n">Iyy</span><span class="p">,</span> 
                            <span class="s2">&quot;Izz&quot;</span> <span class="p">:</span> <span class="n">Izz</span><span class="p">,</span> 
                            <span class="s2">&quot;Iyz&quot;</span> <span class="p">:</span> <span class="n">Iyz</span><span class="p">,</span> 
                            <span class="s2">&quot;Yc&quot;</span> <span class="p">:</span> <span class="n">Yc</span><span class="p">,</span> 
                            <span class="s2">&quot;Zc&quot;</span> <span class="p">:</span> <span class="n">Zc</span>   <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">section_properties</span>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020, MOPT.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>